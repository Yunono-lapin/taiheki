<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>MBTI診断 - 結果ページ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>MBTI診断 - 結果</h1>
    <div id="result"></div>
  </div>

  <script>
    // ローカルストレージから値取得
    const nickname = localStorage.getItem('nickname') || '名無し';
    const answersJSON = localStorage.getItem('answers');
    if (!answersJSON) {
      document.getElementById('result').innerText = '回答データが見つかりません。';
      throw new Error('回答データなし');
    }
    const answers = JSON.parse(answersJSON);

    // 結果候補リスト（1～10）
    let candidateResults = [];

    // Q1で奇数か偶数の結果に限定する（絶対条件）
    if (answers.q1 === 'outdoor' || answers.q1 === 'somewhat_outdoor') {
      // 奇数のみ
      candidateResults = [1, 3, 5, 7, 9];
    } else if (answers.q1 === 'somewhat_indoor' || answers.q1 === 'indoor') {
      // 偶数のみ
      candidateResults = [2, 4, 6, 8, 10];
    } else {
      // Q1の回答が不正なら全部候補
      candidateResults = [1,2,3,4,5,6,7,8,9,10];
    }

    // Q2が「好き」なら1と2を追加（重複除去）
    if (answers.q2 === '好き') {
      [1, 2].forEach(n => {
        if (!candidateResults.includes(n)) candidateResults.push(n);
      });
    }

    // Q3が「とても好き」なら3と4を追加
    if (answers.q3 === 'とても好き') {
      [3, 4].forEach(n => {
        if (!candidateResults.includes(n)) candidateResults.push(n);
      });
    }

    // Q4が「まさにその通り」なら5と6を追加
    if (answers.q4 === 'まさにその通り') {
      [5, 6].forEach(n => {
        if (!candidateResults.includes(n)) candidateResults.push(n);
      });
    }

    // Q5が「かなり」なら7と8を追加
    if (answers.q5 === 'かなり') {
      [7, 8].forEach(n => {
        if (!candidateResults.includes(n)) candidateResults.push(n);
      });
    }

    // Q6が「かなり」なら9と10を追加
    if (answers.q6 === 'かなり') {
      [9, 10].forEach(n => {
        if (!candidateResults.includes(n)) candidateResults.push(n);
      });
    }

    // 最終候補からランダムに1つ選択
    const selected = candidateResults[Math.floor(Math.random() * candidateResults.length)];

    // 結果表示
    const resultDiv = document.getElementById('result');
    resultDiv.innerHTML = `
      <p>ニックネーム：<strong>${nickname}</strong></p>
      <p>あなたの結果は… <strong>${selected}</strong> です！</p>
    `;

  </script>
</body>
</html>
